ChinaPayments.Component["memberpress-payment-handler"]={container:{},configuration:{stripe_publishable_key:"",payment_intent_id:"",payment_intent_secret:"",setup_intent_id:"",setup_intent_secret:"",payment_method:"",return_url:"",return_url_error:"",error_message:""},_stripeSDK:null,Init:function(t){this.container=t;let n=this;china_payments_component_configuration_parse(this,(function(){void 0!==window.Stripe?n.__initStripeSDKLoaded():ChinaPayments.LoadAssets("https://js.stripe.com/v3/",(function(){n.__initStripeSDKLoaded()}),!1)}))},__initStripeSDKLoaded:function(){null===this._stripeSDK&&(this._stripeSDK=window.Stripe(this.configuration.stripe_publishable_key,{apiVersion:"2020-08-27"})),"alipay"===this.configuration.payment_method?this._handleAlipay():"wechat_pay"===this.configuration.payment_method&&this._handleWeChatPay()},_handleAlipay:function(){let t=this;this._stripeSDK.confirmAlipayPayment(this.configuration.payment_intent_secret,{return_url:this.configuration.return_url}).then((function(n){n.error&&(t.container.html('<div data-china-payments-notification="danger">'+t.configuration.error_message+"</div>"),setTimeout((function(){window.location.href=t.configuration.return_url_error}),4e3)),void 0!==n.paymentIntent&&"succeeded"===n.paymentIntent.status&&(window.location.href=t.configuration.return_url)}))},_handleWeChatPay:function(){let t=this;this.container.html(""),this._stripeSDK.confirmWechatPayPayment(this.configuration.payment_intent_secret,{payment_method_options:{wechat_pay:{client:"web"}}}).then((function(n){if(void 0===n.paymentIntent||"succeeded"!==n.paymentIntent.status)return t.container.html('<div data-china-payments-notification="danger">'+t.configuration.error_message+"</div>"),void setTimeout((function(){window.location.href=t.configuration.return_url_error}),4e3);window.location.href=t.configuration.return_url}))}};